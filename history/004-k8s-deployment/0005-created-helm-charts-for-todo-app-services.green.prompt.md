---
id: 0005
title: Created Helm charts for Todo App services
stage: green
date: 2026-02-07
surface: agent
model: gemini
feature: 004-k8s-deployment
branch: 004-k8s-deployment
user: unknown
command: /sp.phr
labels: ["helm", "kubernetes", "charts", "deployment", "setup"]
links:
  spec: specs/004-k8s-deployment/spec.md
  ticket: null
  adr: null
  pr: null
files:
 - charts/frontend/Chart.yaml
 - charts/frontend/values.yaml
 - charts/frontend/templates/deployment.yaml
 - charts/frontend/templates/service.yaml
 - charts/frontend/templates/NOTES.txt
 - charts/backend/Chart.yaml
 - charts/backend/values.yaml
 - charts/backend/templates/deployment.yaml
 - charts/backend/templates/service.yaml
 - charts/backend/templates/secrets.yaml
 - charts/backend/templates/NOTES.txt
 - charts/ai-service/Chart.yaml
 - charts/ai-service/values.yaml
 - charts/ai-service/templates/deployment.yaml
 - charts/ai-service/templates/service.yaml
 - charts/ai-service/templates/secrets.yaml
 - charts/ai-service/templates/NOTES.txt
tests:
 - none
---

## Prompt

---name: kubernetes-helm-deploymentdescription: Kubernetes deployment patterns with Helm charts. Covers deployments, services, ConfigMaps, Secrets, Dapr sidecar injection, health probes, and resource management.---# Kubernetes & Helm Deployment SkillKubernetes deployment patterns using Helm charts for containerized applications.## Quick Start### Installation```bash# Helm 3.xcurl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash# kubectl# See: https://kubernetes.io/docs/tasks/tools/```## 1. Helm Chart Structure### Chart Directory```todo-app/├── Chart.yaml          # Chart metadata├── values.yaml         # Default values├── values-minikube.yaml # Minikube-specific values├── values-oke.yaml     # OKE-specific values└── templates/    ├── deployment.yaml    ├── service.yaml    ├── configmap.yaml    └── ingress.yaml```### Chart.yaml```yamlapiVersion: v2name: todo-appdescription: Todo Chatbot Applicationtype: applicationversion: 1.0.0appVersion: "1.0.0"```## 2. Deployment Template### Basic Deployment```yamlapiVersion: apps/v1kind: Deploymentmetadata:  name: {{ .Values.backend.name }}  labels:    app: {{ .Values.backend.name }}spec:  replicas: {{ .Values.backend.replicas }}  selector:    matchLabels:      app: {{ .Values.backend.name }}  template:    metadata:      labels:        app: {{ .Values.backend.name }}      annotations:        dapr.io/enabled: "true"        dapr.io/app-id: "{{ .Values.backend.name }}"        dapr.io/app-port: "{{ .Values.backend.port }}"        dapr.io/config: "dapr-config"    spec:      containers:        - name: {{ .Values.backend.name }}          image: {{ .Values.backend.image.repository }}:{{ .Values.backend.image.tag }}          ports:            - containerPort: {{ .Values.backend.port }}          env:            - name: DATABASE_URL              valueFrom:                secretKeyRef:                  name: database-secrets                  key: url            - name: DAPR_HTTP_PORT              value: "3500"          resources:            requests:              cpu: {{ .Values.backend.resources.requests.cpu }}              memory: {{ .Values.backend.resources.requests.memory }}            limits:              cpu: {{ .Values.backend.resources.limits.cpu }}              memory: {{ .Values.backend.resources.limits.memory }}          livenessProbe:            httpGet:              path: /health/live              port: {{ .Values.backend.port }}            initialDelaySeconds: 30            periodSeconds: 10          readinessProbe:            httpGet:              path: /health/ready              port: {{ .Values.backend.port }}            initialDelaySeconds: 5            periodSeconds: 5```## 3. Service Template### Service for Backend```yamlapiVersion: v1kind: Servicemetadata:  name: {{ .Values.backend.name }}  labels:    app: {{ .Values.backend.name }}spec:  type: {{ .Values.backend.service.type }}  ports:    - port: {{ .Values.backend.service.port }}      targetPort: {{ .Values.backend.port }}      protocol: TCP  selector:    app: {{ .Values.backend.name }}```## 4. Dapr Sidecar Injection### Dapr Annotations```yamlannotations:  dapr.io/enabled: "true"  dapr.io/app-id: "backend"  dapr.io/app-port: "8000"  dapr.io/config: "dapr-config"  dapr.io/log-level: "info"  dapr.io/log-as-json: "true"```### Dapr Configuration```yamlapiVersion: dapr.io/v1alpha1kind: Configurationmetadata:  name: dapr-config  namespace: defaultspec:  tracing:    samplingRate: "1.0"    zipkin:      endpointAddress: "http://zipkin:9411/api/v2/spans"  metrics:    enabled: true```## 5. Values Files### values.yaml (Default)```yamlbackend:  name: backend  replicas: 2  port: 8000  image:    repository: todo-backend    tag: latest  service:    type: ClusterIP    port: 8000  resources:    requests:      cpu: "100m"      memory: "256Mi"    limits:      cpu: "500m"      memory: "512Mi"frontend:  name: frontend  replicas: 2  port: 3000  image:    repository: todo-frontend    tag: latest  service:    type: ClusterIP    port: 3000```### values-minikube.yaml```yamlbackend:  service:    type: NodePort  resources:    requests:      cpu: "50m"      memory: "128Mi"    limits:      cpu: "200m"      memory: "256Mi"frontend:  service:    type: NodePort```### values-oke.yaml```yamlbackend:  service:    type: LoadBalancer  resources:    requests:      cpu: "200m"      memory: "512Mi"    limits:      cpu: "1000m"      memory: "1Gi"frontend:  service:    type: LoadBalancer```## 6. ConfigMap### ConfigMap Template```yamlapiVersion: v1kind: ConfigMapmetadata:  name: {{ .Values.app.name }}-configdata:  app.env: "production"  log.level: "info"  kafka.brokers: "{{ .Values.kafka.brokers }}"```## 7. Secrets### Secret Template```yamlapiVersion: v1kind: Secretmetadata:  name: database-secretstype: OpaquestringData:  url: "postgresql://user:password@host:5432/db"  password: "secret-password"```### Using Dapr Secrets Instead```yaml# Reference Dapr secret storeenv:  - name: DATABASE_PASSWORD    value: "dapr-secret-store:database-secrets:password"```## 8. Microservices Deployment### Recurring Task Service```yamlapiVersion: apps/v1kind: Deploymentmetadata:  name: recurring-task-servicespec:  replicas: 2  template:    metadata:      annotations:        dapr.io/enabled: "true"        dapr.io/app-id: "recurring-task-service"        dapr.io/app-port: "8001"    spec:      containers:        - name: recurring-task-service          image: recurring-task-service:latest          ports:            - containerPort: 8001          env:            - name: DAPR_HTTP_PORT              value: "3500"```### Notification Service```yamlapiVersion: apps/v1kind: Deploymentmetadata:  name: notification-servicespec:  replicas: 2  template:    metadata:      annotations:        dapr.io/enabled: "true"        dapr.io/app-id: "notification-service"        dapr.io/app-port: "8002"    spec:      containers:        - name: notification-service          image: notification-service:latest          ports:            - containerPort: 8002```## 9. Health Probes### Liveness Probe```yamllivenessProbe:  httpGet:    path: /health/live    port: 8000  initialDelaySeconds: 30  periodSeconds: 10  timeoutSeconds: 5  failureThreshold: 3```### Readiness Probe```yamlreadinessProbe:  httpGet:    path: /health/ready    port: 8000  initialDelaySeconds: 5  periodSeconds: 5  timeoutSeconds: 3  failureThreshold: 3```## 10. Resource Management### Resource Requests and Limits```yamlresources:  requests:    cpu: "100m"      # Minimum CPU    memory: "256Mi"  # Minimum memory  limits:    cpu: "500m"      # Maximum CPU    memory: "512Mi"  # Maximum memory```### Always-Free Tier (OKE)```yaml# OKE always-free tier constraintsresources:  requests:    cpu: "200m"    memory: "512Mi"  limits:    cpu: "2000m"  # 2 OCPUs max    memory: "2Gi"  # 24GB total / 12 pods```## 11. Network Policies### Network Policy Template```yamlapiVersion: networking.k8s.io/v1kind: NetworkPolicymetadata:  name: backend-network-policyspec:  podSelector:    matchLabels:      app: backend  policyTypes:    - Ingress    - Egress  ingress:    - from:        - podSelector:            matchLabels:              app: frontend      ports:        - protocol: TCP          port: 8000  egress:    - to:        - podSelector:            matchLabels:              app: dapr-sidecar      ports:        - protocol: TCP          port: 3500    - to:        - namespaceSelector:            matchLabels:              name: postgresql      ports:        - protocol: TCP          port: 5432```## 12. Deployment Commands### Install Chart```bash# Install with default valueshelm install todo-app ./helm/todo-app# Install with custom valueshelm install todo-app ./helm/todo-app -f values-oke.yaml# Install with overrideshelm install todo-app ./helm/todo-app \  --set backend.replicas=3 \  --set frontend.image.tag=v1.0.0```### Upgrade Chart```bash# Upgrade deploymenthelm upgrade todo-app ./helm/todo-app -f values-oke.yaml# Rollback on failurehelm rollback todo-app```### Uninstall Chart```bashhelm uninstall todo-app```## Best Practices### 1. Use Values Files for Environment-Specific Config```bash# Developmenthelm install todo-app ./helm/todo-app -f values-minikube.yaml# Productionhelm install todo-app ./helm/todo-app -f values-oke.yaml```### 2. Always Set Resource Limits```yamlresources:  limits:    cpu: "500m"    memory: "512Mi"```### 3. Enable Dapr Sidecar```yamlannotations:  dapr.io/enabled: "true"  dapr.io/app-id: "backend"```### 4. Health ProbesAlways include liveness and readiness probes:```yamllivenessProbe:  httpGet:    path: /health/live    port: 8000readinessProbe:  httpGet:    path: /health/ready    port: 8000```## References- [Kubernetes Documentation](https://kubernetes.io/docs/)- [Helm Documentation](https://helm.sh/docs/)- [Dapr Kubernetes](https://docs.dapr.io/operations/hosting/kubernetes/)

implent the helem from this skill